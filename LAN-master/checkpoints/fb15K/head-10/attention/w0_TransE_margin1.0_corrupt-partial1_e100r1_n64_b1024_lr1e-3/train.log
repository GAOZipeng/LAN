2020/10/20 19:42:49: args: Namespace(aggregate_type='attention', allow_soft_placement=False, batch_size=1024, corrupt_mode='partial', data_dir='./data/fb15K/head-10', embedding_dim=100, epoch_per_checkpoint=50, evaluate_size=1000, gpu_device='0', gpu_fraction=0.2, learning_rate=0.001, loss_function='margin', margin=1.0, max_neighbor=64, n_neg=1, num_epoch=1000, save_dir='./checkpoints/fb15K/head-10/attention/w0_TransE_margin1.0_corrupt-partial1_e100r1_n64_b1024_lr1e-3/', score_function='TransE', steps_per_display=100, use_relation=1, weight_decay=0.0)
2020/10/20 19:42:49: Loading data...
2020/10/20 19:42:58: got 10336 entities for training
2020/10/20 19:42:58: got 1170 relations for training
2020/10/20 19:42:59: got 108854 triplets for train
2020/10/20 19:42:59: got 11333 triplets for valid
2020/10/20 19:42:59: got 2731 triplets for test
2020/10/20 19:43:00: Loading finish...
2020/10/20 19:43:01: Train with 106 batches
2020/10/20 19:43:30: epoch 0, batch 99, loss: 0.250, time: 0.221s
2020/10/20 19:43:32: epoch 0, batch 105, loss: 0.256, time: 0.202s
2020/10/20 19:43:32: epoch 0, mean loss: 0.573, time: 31.151s
2020/10/20 19:44:01: epoch 1, batch 99, loss: 0.101, time: 0.184s
2020/10/20 19:44:03: epoch 1, batch 105, loss: 0.079, time: 0.233s
2020/10/20 19:44:03: epoch 1, mean loss: 0.100, time: 30.605s
2020/10/20 19:44:31: epoch 2, batch 99, loss: 0.050, time: 0.208s
2020/10/20 19:44:33: epoch 2, batch 105, loss: 0.050, time: 0.221s
2020/10/20 19:44:33: epoch 2, mean loss: 0.057, time: 30.167s
2020/10/20 19:45:01: epoch 3, batch 99, loss: 0.047, time: 0.221s
2020/10/20 19:45:03: epoch 3, batch 105, loss: 0.048, time: 0.222s
2020/10/20 19:45:03: epoch 3, mean loss: 0.041, time: 30.050s
2020/10/20 19:45:31: epoch 4, batch 99, loss: 0.030, time: 0.199s
2020/10/20 19:45:33: epoch 4, batch 105, loss: 0.028, time: 0.241s
2020/10/20 19:45:33: epoch 4, mean loss: 0.033, time: 30.308s
2020/10/20 19:46:02: epoch 5, batch 99, loss: 0.028, time: 0.211s
2020/10/20 19:46:04: epoch 5, batch 105, loss: 0.026, time: 0.203s
2020/10/20 19:46:04: epoch 5, mean loss: 0.029, time: 30.584s
2020/10/20 19:46:29: epoch 6, batch 99, loss: 0.026, time: 0.159s
2020/10/20 19:46:31: epoch 6, batch 105, loss: 0.026, time: 0.159s
2020/10/20 19:46:31: epoch 6, mean loss: 0.025, time: 26.748s
2020/10/20 19:46:53: epoch 7, batch 99, loss: 0.021, time: 0.158s
2020/10/20 19:46:54: epoch 7, batch 105, loss: 0.024, time: 0.159s
2020/10/20 19:46:55: epoch 7, mean loss: 0.023, time: 23.856s
2020/10/20 19:47:16: epoch 8, batch 99, loss: 0.025, time: 0.159s
2020/10/20 19:47:18: epoch 8, batch 105, loss: 0.020, time: 0.158s
2020/10/20 19:47:18: epoch 8, mean loss: 0.021, time: 23.301s
2020/10/20 19:47:40: epoch 9, batch 99, loss: 0.024, time: 0.159s
2020/10/20 19:47:42: epoch 9, batch 105, loss: 0.020, time: 0.158s
2020/10/20 19:47:42: epoch 9, mean loss: 0.020, time: 23.932s
2020/10/20 19:48:04: epoch 10, batch 99, loss: 0.020, time: 0.159s
2020/10/20 19:48:05: epoch 10, batch 105, loss: 0.019, time: 0.159s
2020/10/20 19:48:06: epoch 10, mean loss: 0.019, time: 23.829s
2020/10/20 19:48:28: epoch 11, batch 99, loss: 0.015, time: 0.159s
2020/10/20 19:48:29: epoch 11, batch 105, loss: 0.019, time: 0.159s
2020/10/20 19:48:30: epoch 11, mean loss: 0.017, time: 23.899s
2020/10/20 19:48:52: epoch 12, batch 99, loss: 0.015, time: 0.160s
2020/10/20 19:48:53: epoch 12, batch 105, loss: 0.027, time: 0.159s
2020/10/20 19:48:54: epoch 12, mean loss: 0.017, time: 23.936s
2020/10/20 19:49:16: epoch 13, batch 99, loss: 0.020, time: 0.159s
2020/10/20 19:49:17: epoch 13, batch 105, loss: 0.025, time: 0.159s
2020/10/20 19:49:18: epoch 13, mean loss: 0.016, time: 24.016s
2020/10/20 19:49:41: epoch 14, batch 99, loss: 0.016, time: 0.200s
2020/10/20 19:49:42: epoch 14, batch 105, loss: 0.016, time: 0.196s
2020/10/20 19:49:43: epoch 14, mean loss: 0.016, time: 25.163s
2020/10/20 19:50:09: epoch 15, batch 99, loss: 0.017, time: 0.218s
2020/10/20 19:50:11: epoch 15, batch 105, loss: 0.013, time: 0.171s
2020/10/20 19:50:11: epoch 15, mean loss: 0.015, time: 28.391s
2020/10/20 19:50:38: epoch 16, batch 99, loss: 0.012, time: 0.188s
2020/10/20 19:50:39: epoch 16, batch 105, loss: 0.013, time: 0.208s
2020/10/20 19:50:40: epoch 16, mean loss: 0.015, time: 28.520s
2020/10/20 19:51:06: epoch 17, batch 99, loss: 0.019, time: 0.209s
2020/10/20 19:51:07: epoch 17, batch 105, loss: 0.008, time: 0.182s
2020/10/20 19:51:08: epoch 17, mean loss: 0.015, time: 28.077s
2020/10/20 19:51:33: epoch 18, batch 99, loss: 0.019, time: 0.159s
2020/10/20 19:51:35: epoch 18, batch 105, loss: 0.015, time: 0.158s
2020/10/20 19:51:35: epoch 18, mean loss: 0.014, time: 27.077s
2020/10/20 19:52:00: epoch 19, batch 99, loss: 0.022, time: 0.196s
2020/10/20 19:52:02: epoch 19, batch 105, loss: 0.012, time: 0.197s
2020/10/20 19:52:02: epoch 19, mean loss: 0.014, time: 27.053s
2020/10/20 19:52:27: epoch 20, batch 99, loss: 0.008, time: 0.206s
2020/10/20 19:52:29: epoch 20, batch 105, loss: 0.014, time: 0.171s
2020/10/20 19:52:29: epoch 20, mean loss: 0.013, time: 27.279s
2020/10/20 19:52:55: epoch 21, batch 99, loss: 0.021, time: 0.194s
2020/10/20 19:52:57: epoch 21, batch 105, loss: 0.007, time: 0.202s
2020/10/20 19:52:57: epoch 21, mean loss: 0.014, time: 27.746s
2020/10/20 19:53:23: epoch 22, batch 99, loss: 0.019, time: 0.202s
2020/10/20 19:53:24: epoch 22, batch 105, loss: 0.014, time: 0.193s
2020/10/20 19:53:25: epoch 22, mean loss: 0.014, time: 27.674s
2020/10/20 19:53:50: epoch 23, batch 99, loss: 0.014, time: 0.194s
2020/10/20 19:53:52: epoch 23, batch 105, loss: 0.009, time: 0.176s
2020/10/20 19:53:52: epoch 23, mean loss: 0.013, time: 27.388s
2020/10/20 19:54:17: epoch 24, batch 99, loss: 0.012, time: 0.210s
2020/10/20 19:54:19: epoch 24, batch 105, loss: 0.007, time: 0.195s
2020/10/20 19:54:19: epoch 24, mean loss: 0.012, time: 27.396s
2020/10/20 19:54:45: epoch 25, batch 99, loss: 0.021, time: 0.208s
2020/10/20 19:54:47: epoch 25, batch 105, loss: 0.015, time: 0.197s
2020/10/20 19:54:47: epoch 25, mean loss: 0.012, time: 27.611s
2020/10/20 19:55:13: epoch 26, batch 99, loss: 0.005, time: 0.171s
2020/10/20 19:55:14: epoch 26, batch 105, loss: 0.015, time: 0.176s
2020/10/20 19:55:15: epoch 26, mean loss: 0.012, time: 27.674s
2020/10/20 19:55:39: epoch 27, batch 99, loss: 0.018, time: 0.158s
2020/10/20 19:55:40: epoch 27, batch 105, loss: 0.008, time: 0.159s
2020/10/20 19:55:40: epoch 27, mean loss: 0.011, time: 25.676s
2020/10/20 19:56:02: epoch 28, batch 99, loss: 0.010, time: 0.158s
2020/10/20 19:56:03: epoch 28, batch 105, loss: 0.010, time: 0.158s
2020/10/20 19:56:04: epoch 28, mean loss: 0.012, time: 23.410s
2020/10/20 19:56:26: epoch 29, batch 99, loss: 0.010, time: 0.158s
2020/10/20 19:56:27: epoch 29, batch 105, loss: 0.011, time: 0.159s
2020/10/20 19:56:27: epoch 29, mean loss: 0.011, time: 23.772s
2020/10/20 19:56:50: epoch 30, batch 99, loss: 0.013, time: 0.159s
2020/10/20 19:56:51: epoch 30, batch 105, loss: 0.009, time: 0.158s
2020/10/20 19:56:52: epoch 30, mean loss: 0.011, time: 24.034s
2020/10/20 19:57:14: epoch 31, batch 99, loss: 0.015, time: 0.159s
2020/10/20 19:57:15: epoch 31, batch 105, loss: 0.005, time: 0.159s
2020/10/20 19:57:15: epoch 31, mean loss: 0.011, time: 23.802s
2020/10/20 19:57:38: epoch 32, batch 99, loss: 0.008, time: 0.158s
2020/10/20 19:57:39: epoch 32, batch 105, loss: 0.010, time: 0.159s
2020/10/20 19:57:39: epoch 32, mean loss: 0.012, time: 23.940s
2020/10/20 19:58:01: epoch 33, batch 99, loss: 0.008, time: 0.158s
2020/10/20 19:58:03: epoch 33, batch 105, loss: 0.008, time: 0.159s
2020/10/20 19:58:03: epoch 33, mean loss: 0.010, time: 23.865s
2020/10/20 19:58:25: epoch 34, batch 99, loss: 0.013, time: 0.160s
2020/10/20 19:58:27: epoch 34, batch 105, loss: 0.005, time: 0.159s
2020/10/20 19:58:27: epoch 34, mean loss: 0.012, time: 23.920s
2020/10/20 19:58:49: epoch 35, batch 99, loss: 0.019, time: 0.158s
2020/10/20 19:58:51: epoch 35, batch 105, loss: 0.008, time: 0.158s
2020/10/20 19:58:51: epoch 35, mean loss: 0.011, time: 23.818s
2020/10/20 19:59:13: epoch 36, batch 99, loss: 0.013, time: 0.159s
2020/10/20 19:59:15: epoch 36, batch 105, loss: 0.019, time: 0.160s
2020/10/20 19:59:15: epoch 36, mean loss: 0.010, time: 23.989s
2020/10/20 19:59:37: epoch 37, batch 99, loss: 0.006, time: 0.158s
2020/10/20 19:59:38: epoch 37, batch 105, loss: 0.017, time: 0.158s
2020/10/20 19:59:39: epoch 37, mean loss: 0.010, time: 23.759s
2020/10/20 20:00:01: epoch 38, batch 99, loss: 0.009, time: 0.158s
2020/10/20 20:00:02: epoch 38, batch 105, loss: 0.010, time: 0.159s
2020/10/20 20:00:02: epoch 38, mean loss: 0.010, time: 23.862s
2020/10/20 20:00:25: epoch 39, batch 99, loss: 0.009, time: 0.159s
2020/10/20 20:00:26: epoch 39, batch 105, loss: 0.008, time: 0.159s
2020/10/20 20:00:26: epoch 39, mean loss: 0.010, time: 23.908s
2020/10/20 20:00:49: epoch 40, batch 99, loss: 0.015, time: 0.159s
2020/10/20 20:00:50: epoch 40, batch 105, loss: 0.009, time: 0.161s
2020/10/20 20:00:50: epoch 40, mean loss: 0.011, time: 23.999s
2020/10/20 20:01:13: epoch 41, batch 99, loss: 0.006, time: 0.158s
2020/10/20 20:01:14: epoch 41, batch 105, loss: 0.009, time: 0.158s
2020/10/20 20:01:14: epoch 41, mean loss: 0.010, time: 24.053s
2020/10/20 20:01:37: epoch 42, batch 99, loss: 0.009, time: 0.158s
2020/10/20 20:01:38: epoch 42, batch 105, loss: 0.008, time: 0.159s
2020/10/20 20:01:38: epoch 42, mean loss: 0.010, time: 23.862s
2020/10/20 20:02:00: epoch 43, batch 99, loss: 0.011, time: 0.159s
2020/10/20 20:02:02: epoch 43, batch 105, loss: 0.006, time: 0.158s
2020/10/20 20:02:02: epoch 43, mean loss: 0.011, time: 23.766s
2020/10/20 20:02:24: epoch 44, batch 99, loss: 0.017, time: 0.158s
2020/10/20 20:02:26: epoch 44, batch 105, loss: 0.006, time: 0.159s
2020/10/20 20:02:26: epoch 44, mean loss: 0.010, time: 23.939s
2020/10/20 20:02:48: epoch 45, batch 99, loss: 0.012, time: 0.158s
2020/10/20 20:02:50: epoch 45, batch 105, loss: 0.010, time: 0.158s
2020/10/20 20:02:50: epoch 45, mean loss: 0.009, time: 23.963s
2020/10/20 20:03:11: epoch 46, batch 99, loss: 0.007, time: 0.158s
2020/10/20 20:03:13: epoch 46, batch 105, loss: 0.006, time: 0.158s
2020/10/20 20:03:13: epoch 46, mean loss: 0.010, time: 23.061s
2020/10/20 20:03:35: epoch 47, batch 99, loss: 0.008, time: 0.159s
2020/10/20 20:03:37: epoch 47, batch 105, loss: 0.004, time: 0.159s
2020/10/20 20:03:37: epoch 47, mean loss: 0.009, time: 23.776s
2020/10/20 20:03:59: epoch 48, batch 99, loss: 0.009, time: 0.159s
2020/10/20 20:04:01: epoch 48, batch 105, loss: 0.005, time: 0.158s
2020/10/20 20:04:01: epoch 48, mean loss: 0.009, time: 24.086s
2020/10/20 20:04:23: epoch 49, batch 99, loss: 0.013, time: 0.158s
2020/10/20 20:04:25: epoch 49, batch 105, loss: 0.008, time: 0.248s
2020/10/20 20:04:25: epoch 49, mean loss: 0.009, time: 24.402s
2020/10/20 20:04:25: evaluating the current model...
